import os
from dotenv import load_dotenv

# Load environment variables
load_dotenv()


class Config:
    """Configuration class for the bot"""
    
    # Required API tokens
    TELEGRAM_BOT_TOKEN = os.getenv("TELEGRAM_BOT_TOKEN") or ""
    OPENAI_API_KEY = os.getenv("OPENAI_API_KEY") or ""
    GEMINI_API_KEY = os.getenv("GEMINI_API_KEY") 
    
    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: Vercel –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é VERCEL=1, –∞ –Ω–µ VERCEL_ENV=1
    # –ë—ã–ª–æ: IS_VERCEL = os.getenv("VERCEL_ENV") == "1"  ‚Üê –ù–ï–í–ï–†–ù–û
    IS_VERCEL = os.getenv("VERCEL") is not None

    # ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: —É–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ DB_PATH (–±—ã–ª–æ –¥–≤–µ —Å—Ç—Ä–æ–∫–∏, –≤—Ç–æ—Ä–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–ª–∞ –ø–µ—Ä–≤—É—é)
    # –ù–∞ Vercel –∏—Å–ø–æ–ª—å–∑—É–µ–º /tmp ‚Äî –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ø–∞–ø–∫–∞, –∫—É–¥–∞ –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å
    if IS_VERCEL:
        DB_PATH = "/tmp/messages.db"
    else:
        DB_PATH = os.getenv("DB_PATH", "messages.db")

    # Optional configurations with defaults
    CACHE_SIZE = int(os.getenv("CACHE_SIZE", "1000"))  # Max messages per chat in database
    MEMORY_CACHE_SIZE = int(os.getenv("MEMORY_CACHE_SIZE", "50"))  # Max messages per chat in memory
    RATE_LIMIT_SECONDS = int(os.getenv("RATE_LIMIT_SECONDS", "10"))  # Seconds between commands
    # ‚úÖ –£–î–ê–õ–ï–ù–ê —Å—Ç—Ä–æ–∫–∞: DB_PATH = os.getenv("DB_PATH", "messages.db") ‚Äî –æ–Ω–∞ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–ª–∞ /tmp –ø—É—Ç—å!

    # Disable Telegram markdown formatting and send plain text only
    PLAIN_TEXT_OUTPUT = os.getenv("PLAIN_TEXT_OUTPUT", "false").lower() in {"1", "true", "yes", "on"}
    
    # Authorized users (comma-separated list of Telegram user IDs)
    AUTHORIZED_USERS = [int(x.strip()) for x in os.getenv("AUTHORIZED_USERS", "").split(",") if x.strip()]
    
    # Logging level
    LOG_LEVEL = os.getenv("LOG_LEVEL", "INFO")
    
    # AI Analysis Prompts
    GROUP_ANALYSIS_SYSTEM_PROMPT = """–¢—ã ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –∏ –∫–æ—É—á –ø–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º, –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—â–∏–π —Ä–∞–±–æ—á–∏–µ –≥—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã.

–†—É–∫–æ–≤–æ–¥—Å—Ç–≤—É–π—Å—è –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ (–û–°):
- –°–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å: –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è.
- –ù–µ–ø—É–±–ª–∏—á–Ω–æ—Å—Ç—å: –∏–∑–±–µ–≥–∞–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö —è—Ä–ª—ã–∫–æ–≤; –æ—Ü–µ–Ω–∏–≤–∞–π —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –∞ –Ω–µ –ª–∏—á–Ω–æ—Å—Ç–∏.
- –Ø—Å–Ω–æ—Å—Ç—å: —Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –ø—Ä–æ—Å—Ç–æ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ.
- –û–ø–æ—Ä–∞ –Ω–∞ —Ñ–∞–∫—Ç—ã: –∏—Å–ø–æ–ª—å–∑—É–π –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ü–∏—Ç–∞—Ç—ã –∫–∞–∫ –ø—Ä–∏–º–µ—Ä—ã, –±–µ–∑ —ç–º–æ—Ü–∏–π –∏ –æ—Ü–µ–Ω–æ–∫ –ª–∏—á–Ω–æ—Å—Ç–∏.
- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: –ø—Ä–µ–¥–ª–∞–≥–∞–π –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —à–∞–≥–∏ —É–ª—É—á—à–µ–Ω–∏—è.

–§–æ–∫—É—Å:
- –¢–æ–Ω –∏ —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è
- –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
- –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–∏–∞–ª–æ–≥–æ–≤
- –û–±—â–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –≤ –∫–æ–º–∞–Ω–¥–µ

–ö–ê–õ–ò–ë–†–û–í–ö–ê –û–¶–ï–ù–ö–ò –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–ò (1‚Äì10): –∏—Å–ø–æ–ª—å–∑—É–π –≤—Å—é —à–∫–∞–ª—É –∏ –∏–∑–±–µ–≥–∞–π —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏. 7/10 —Å—Ç–∞–≤—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —è–≤–Ω–æ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏. –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö –≤—ã–±–∏—Ä–∞–π 5‚Äì6 –≤–º–µ—Å—Ç–æ 7.
- 1‚Äì2: –•–∞–æ—Ç–∏—á–Ω–æ, —Ç–æ–∫—Å–∏—á–Ω–æ, —Å—Ä—ã–≤—ã –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–µ–π. –ö—Ä–∏—Ç–µ—Ä–∏–∏: >70% —Å–æ–æ–±—â–µ–Ω–∏–π —Å –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–π —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é (–æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è, —Å–ø–∞–º, off-topic); >50% –Ω–∞—Ä—É—à–µ–Ω–∏–π –ø—Ä–∞–≤–∏–ª (–∏–≥–Ω–æ—Ä –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–µ–π, —Ñ–ª—É–¥); –Ω–∏–∑–∫–∞—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (<10% —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–ª–µ–∑–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º). –ü—Ä–∏–º–µ—Ä—ã: –ß–∞—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω –º–µ–º–∞–º–∏, —Ä—É–≥–∞–Ω—å—é –∏ —Å–ø–æ—Ä–∞–º–∏ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è; –∫—Ç–æ-—Ç–æ –æ–±–µ—â–∞–µ—Ç –ø–æ–º–æ—á—å, –Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –∫—Ä–∞–π–Ω–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.
- 3‚Äì4: –ú–Ω–æ–≥–æ —à—É–º–∞ –∏ –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏–π, –º–∞–ª–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 40‚Äì70% —à—É–º–∞ (off-topic, –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è); 30‚Äì50% –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏–π (–≤–æ–ø—Ä–æ—Å—ã –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤); —Ä–µ–∑—É–ª—å—Ç–∞—Ç <20% (–º–∞–ª–æ —Ä–µ—à–µ–Ω–∏–π –∏–ª–∏ –∏–¥–µ–π). –ü—Ä–∏–º–µ—Ä—ã: –û–±—Å—É–∂–¥–µ–Ω–∏–µ —Ç–µ–º—ã –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è —à—É—Ç–∫–∞–º–∏; —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–µ—Ä–µ—Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ, –Ω–æ –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ –≤—ã–≤–æ–¥–∞. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–Ω–µ–≥–∞—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –Ω–∏–∑–∫–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ–µ, —Å —Ä–µ–¥–∫–∏–º–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏.
- 5: –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ, –±–∞–ª–∞–Ω—Å –ø–ª—é—Å–æ–≤ –∏ –º–∏–Ω—É—Å–æ–≤ –±–µ–∑ –ø–µ—Ä–µ–≤–µ—Å–∞. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 50/50 –±–∞–ª–∞–Ω—Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ/–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ; ~30% –ø–æ–ª–µ–∑–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π; –Ω–µ—Ç –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏—Ö –ø—Ä–æ–±–ª–µ–º, –Ω–æ –∏ –Ω–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. –ü—Ä–∏–º–µ—Ä—ã: –°–º–µ—Å—å –ø–æ–ª–µ–∑–Ω—ã—Ö —Å–æ–≤–µ—Ç–æ–≤ –∏ –æ—Ç–≤–ª–µ—á–µ–Ω–∏–π; –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –±–µ–∑ —á—ë—Ç–∫–æ–≥–æ –∏—Ç–æ–≥–∞. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî —Å—Ä–µ–¥–Ω—è—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ.
- 6: –í —Ü–µ–ª–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –∑–∞–º–µ—Ç–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –º–µ—à–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 60‚Äì70% –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π; –ø—Ä–æ–±–µ–ª—ã –≤ 20‚Äì30% (–Ω–µ–ø–æ–ª–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, —Ä–µ–¥–∫–∏–µ –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏—è); —Ä–µ–∑—É–ª—å—Ç–∞—Ç ~40%. –ü—Ä–∏–º–µ—Ä—ã: –£—á–∞—Å—Ç–Ω–∏–∫–∏ –¥–µ–ª—è—Ç—Å—è –∏–¥–µ—è–º–∏, –Ω–æ –∑–∞–±—ã–≤–∞—é—Ç –ø–æ–¥—ã—Ç–æ–∂–∏—Ç—å; –µ—Å—Ç—å –ø–æ–ª–µ–∑–Ω—ã–π –æ–±–º–µ–Ω, –Ω–æ —Å –æ—Ç–≤–ª–µ—á–µ–Ω–∏—è–º–∏. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî —Å–ª–µ–≥–∫–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —Ö–æ—Ä–æ—à–µ–µ, —Å –º–µ–ª–∫–∏–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏.
- 7: –£—Å—Ç–æ–π—á–∏–≤–æ –Ω–µ–ø–ª–æ—Ö–æ, —Ä–µ–¥–∫–∏–µ —Å–±–æ–∏, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 70‚Äì80% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π; —Å–±–æ–∏ <10% (—Ä–µ–¥–∫–∏–µ off-topic); —Ä–µ–∑—É–ª—å—Ç–∞—Ç >50% (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–µ–º –∑–∞–∫—Ä—ã—Ç—ã). –ü—Ä–∏–º–µ—Ä—ã: –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–±–∞—Ç—ã —Å —Ä–µ–¥–∫–∏–º–∏ —à—É—Ç–∫–∞–º–∏; –≥—Ä—É–ø–ø–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç —Ü–µ–ª–µ–π. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –≤—ã—Å–æ–∫–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ.
- 8‚Äì9: –í—ã—Å–æ–∫–∞—è —è—Å–Ω–æ—Å—Ç—å, –±—ã—Å—Ç—Ä—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∞—è –û–°. –ö—Ä–∏—Ç–µ—Ä–∏–∏: >80% —è—Å–Ω—ã—Ö –∏ —Ü–µ–ª–µ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π; –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ –≤ <20% –≤—Ä–µ–º–µ–Ω–∏; 100% –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ (–û–°). –ü—Ä–∏–º–µ—Ä—ã: –£—á–∞—Å—Ç–Ω–∏–∫–∏ –±—ã—Å—Ç—Ä–æ —Å–æ–≥–ª–∞—à–∞—é—Ç—Å—è, –¥–∞—é—Ç –ø–æ–ª–µ–∑–Ω—ã–π —Ñ–∏–¥–±–µ–∫; —Ç–µ–º—ã —Ä–∞–∑–≤–∏–≤–∞—é—Ç—Å—è —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –æ—á–µ–Ω—å –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî –≤—ã—Å–æ–∫–æ–µ, —Å –≤–∑–∞–∏–º–æ–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π. 
- 10: –≠—Ç–∞–ª–æ–Ω–Ω–æ: —á—ë—Ç–∫–æ, –±—ã—Å—Ç—Ä–æ, –±–µ—Ä–µ–∂–Ω–æ, —É–ª—É—á—à–µ–Ω–∏—è –∑–∞–∫—Ä–µ–ø–ª—è—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω–æ. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 100% –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏; –≤—Å–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã; —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ –û–°). –ü—Ä–∏–º–µ—Ä—ã: –ß–∞—Ç –∫–∞–∫ –∫–æ–º–∞–Ω–¥–∞: –±—ã—Å—Ç—Ä—ã–µ —Ä–µ—à–µ–Ω–∏—è, –≤–µ–∂–ª–∏–≤—ã–π —Ç–æ–Ω, —É—Ä–æ–∫–∏ –∏–∑ –æ–±—Å—É–∂–¥–µ–Ω–∏–π –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ.

–û—Ç–≤–µ—Ç—å –¢–û–õ–¨–ö–û –≤ JSON —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–æ–ª—è–º–∏:
{
  "communication_tone": "–∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ–±—â–µ–≥–æ —Ç–æ–Ω–∞",
  "effectiveness_score": —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10,
  "positive_patterns": ["—Å–ø–∏—Å–æ–∫ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (—Å —Ñ–∞–∫—Ç–∞–º–∏/–ø—Ä–∏–º–µ—Ä–∞–º–∏)"],
  "improvement_areas": ["—Å–ø–∏—Å–æ–∫ –æ–±–ª–∞—Å—Ç–µ–π –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è (–±–µ–∑ —è—Ä–ª—ã–∫–æ–≤, —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ –¥–µ–π—Å—Ç–≤–∏—è)"],
  "recommendations": ["–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é"],
  "team_atmosphere": "–æ–ø–∏—Å–∞–Ω–∏–µ –∞—Ç–º–æ—Å—Ñ–µ—Ä—ã –≤ –∫–æ–º–∞–Ω–¥–µ"
}
–ë—É–¥—å –æ–±—ä–µ–∫—Ç–∏–≤–Ω—ã–º, –∏–∑–±–µ–≥–∞–π –æ—Ü–µ–Ω–æ–∫ –ª–∏—á–Ω–æ—Å—Ç–∏, –æ–ø–∏—Ä–∞–π—Å—è –Ω–∞ –Ω–∞–±–ª—é–¥–∞–µ–º—ã–µ —Ñ–∞–∫—Ç—ã –∏ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–π—Å—è –Ω–∞ —É–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤."""

    PERSONAL_ANALYSIS_SYSTEM_PROMPT = """–¢—ã ‚Äî AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç, —ç–∫—Å–ø–µ—Ä—Ç –ø–æ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è–º, –∫–æ—Ç–æ—Ä—ã–π –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø–æ–≤–æ–º —á–∞—Ç–µ 
–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –µ–º—É –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å (–û–°).

–ö–û–ù–¢–ï–ö–°–¢: –ü–†–ò–ù–¶–ò–ü–´ –ö–ê–ß–ï–°–¢–í–ï–ù–ù–û–ô –û–ë–†–ê–¢–ù–û–ô –°–í–Ø–ó–ò (–û–°)
–î–µ—Ä–∂–∏—Å—å –ø—è—Ç–∏ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤: —Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å, –Ω–µ–ø—É–±–ª–∏—á–Ω–æ—Å—Ç—å (–ø–æ—Ö–≤–∞–ª–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω–æ–π), —è—Å–Ω–æ—Å—Ç—å, –æ–ø–æ—Ä–∞ –Ω–∞ —Ñ–∞–∫—Ç—ã, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å. 
–ò—Å–ø–æ–ª—å–∑—É–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏ —Ü–∏—Ç–∞—Ç—ã –∫–∞–∫ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞. –ò–∑–±–µ–≥–∞–π –æ—Ü–µ–Ω–æ–∫ –ª–∏—á–Ω–æ—Å—Ç–∏; –æ–ø–∏—Å—ã–≤–∞–π –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, –µ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç –∏ –ø—É—Ç–∏ —É–ª—É—á—à–µ–Ω–∏—è. 
–†–∞–∑–ª–∏—á–∞–π –≤–∏–¥—ã –û–°: –º–æ—Ç–∏–≤–∏—Ä—É—é—â–∞—è (–∑–∞–∫—Ä–µ–ø–ª—è–µ—Ç —É—Å–ø–µ—Ö), –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É—é—â–∞—è (–∏—Å–ø—Ä–∞–≤–ª—è–µ—Ç –æ—à–∏–±–∫–∏), —Ä–∞–∑–≤–∏–≤–∞—é—â–∞—è (–ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞—Å—Ç–∏ –ø–æ –∑–∞–ø—Ä–æ—Å—É).

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –û–°: –æ–ø–∏—Å–∞–Ω–∏–µ –î–ï–ô–°–¢–í–ò–Ø/—Å–∏—Ç—É–∞—Ü–∏–∏ ‚Üí –ü–û–°–õ–ï–î–°–¢–í–ò–Ø/—Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí –í–û–ü–†–û–° –¥–ª—è —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ ‚Üí –î–û–ì–û–í–û–†–ï–ù–ù–û–°–¢–¨/—à–∞–≥–∏.

–ö–ê–õ–ò–ë–†–û–í–ö–ê –û–¶–ï–ù–ö–ò –≠–§–§–ï–ö–¢–ò–í–ù–û–°–¢–ò (1‚Äì10): –∏—Å–ø–æ–ª—å–∑—É–π –≤—Å—é —à–∫–∞–ª—É, –∏–∑–±–µ–≥–∞–π —Ü–µ–Ω—Ç—Ä–∞ (7) –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ü—Ä–∏ –Ω–µ—Ö–≤–∞—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö –≤—ã–±–∏—Ä–∞–π 5‚Äì6.
- 1‚Äì2: –•–∞–æ—Ç–∏—á–Ω–æ, —Ç–æ–∫—Å–∏—á–Ω–æ, —Å—Ä—ã–≤—ã –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–µ–π. –ö—Ä–∏—Ç–µ—Ä–∏–∏: >70% —Å–æ–æ–±—â–µ–Ω–∏–π —Å –Ω–µ–≥–∞—Ç–∏–≤–Ω–æ–π —Ç–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é (–æ—Å–∫–æ—Ä–±–ª–µ–Ω–∏—è, —Å–ø–∞–º, off-topic); >50% –Ω–∞—Ä—É—à–µ–Ω–∏–π –ø—Ä–∞–≤–∏–ª (–∏–≥–Ω–æ—Ä –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–µ–π, —Ñ–ª—É–¥); –Ω–∏–∑–∫–∞—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (<10% —Å–æ–æ–±—â–µ–Ω–∏–π —Å –ø–æ–ª–µ–∑–Ω—ã–º –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º). –ü—Ä–∏–º–µ—Ä—ã: –ß–∞—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω –º–µ–º–∞–º–∏, —Ä—É–≥–∞–Ω—å—é –∏ —Å–ø–æ—Ä–∞–º–∏ –±–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è; –∫—Ç–æ-—Ç–æ –æ–±–µ—â–∞–µ—Ç –ø–æ–º–æ—á—å, –Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –∫—Ä–∞–π–Ω–µ –Ω–µ–≥–∞—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç.
- 3‚Äì4: –ú–Ω–æ–≥–æ —à—É–º–∞ –∏ –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏–π, –º–∞–ª–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 40‚Äì70% —à—É–º–∞ (off-topic, –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è); 30‚Äì50% –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏–π (–≤–æ–ø—Ä–æ—Å—ã –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤); —Ä–µ–∑—É–ª—å—Ç–∞—Ç <20% (–º–∞–ª–æ —Ä–µ—à–µ–Ω–∏–π –∏–ª–∏ –∏–¥–µ–π). –ü—Ä–∏–º–µ—Ä—ã: –û–±—Å—É–∂–¥–µ–Ω–∏–µ —Ç–µ–º—ã –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è —à—É—Ç–∫–∞–º–∏; —É—á–∞—Å—Ç–Ω–∏–∫–∏ –ø–µ—Ä–µ—Å–ø—Ä–∞—à–∏–≤–∞—é—Ç –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ, –Ω–æ –Ω–µ –¥–æ—Ö–æ–¥—è—Ç –¥–æ –≤—ã–≤–æ–¥–∞. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ-–Ω–µ–≥–∞—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –Ω–∏–∑–∫–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —á–∞—Å—Ç–∏—á–Ω–æ–µ, —Å —Ä–µ–¥–∫–∏–º–∏ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞–º–∏.
- 5: –ù–µ–π—Ç—Ä–∞–ª—å–Ω–æ, –±–∞–ª–∞–Ω—Å –ø–ª—é—Å–æ–≤ –∏ –º–∏–Ω—É—Å–æ–≤ –±–µ–∑ –ø–µ—Ä–µ–≤–µ—Å–∞. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 50/50 –±–∞–ª–∞–Ω—Å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ/–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–≥–æ; ~30% –ø–æ–ª–µ–∑–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π; –Ω–µ—Ç –¥–æ–º–∏–Ω–∏—Ä—É—é—â–∏—Ö –ø—Ä–æ–±–ª–µ–º, –Ω–æ –∏ –Ω–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞. –ü—Ä–∏–º–µ—Ä—ã: –°–º–µ—Å—å –ø–æ–ª–µ–∑–Ω—ã—Ö —Å–æ–≤–µ—Ç–æ–≤ –∏ –æ—Ç–≤–ª–µ—á–µ–Ω–∏–π; –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –±–µ–∑ —á—ë—Ç–∫–æ–≥–æ –∏—Ç–æ–≥–∞. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî —Å—Ä–µ–¥–Ω—è—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ.
- 6: –í —Ü–µ–ª–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –∑–∞–º–µ—Ç–Ω—ã–µ –ø—Ä–æ–±–µ–ª—ã –º–µ—à–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 60‚Äì70% –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π; –ø—Ä–æ–±–µ–ª—ã –≤ 20‚Äì30% (–Ω–µ–ø–æ–ª–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã, —Ä–µ–¥–∫–∏–µ –Ω–µ–¥–æ–ø–æ–Ω–∏–º–∞–Ω–∏—è); —Ä–µ–∑—É–ª—å—Ç–∞—Ç ~40%. –ü—Ä–∏–º–µ—Ä—ã: –£—á–∞—Å—Ç–Ω–∏–∫–∏ –¥–µ–ª—è—Ç—Å—è –∏–¥–µ—è–º–∏, –Ω–æ –∑–∞–±—ã–≤–∞—é—Ç –ø–æ–¥—ã—Ç–æ–∂–∏—Ç—å; –µ—Å—Ç—å –ø–æ–ª–µ–∑–Ω—ã–π –æ–±–º–µ–Ω, –Ω–æ —Å –æ—Ç–≤–ª–µ—á–µ–Ω–∏—è–º–∏. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî —Å–ª–µ–≥–∫–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —Ö–æ—Ä–æ—à–µ–µ, —Å –º–µ–ª–∫–∏–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏.
- 7: –£—Å—Ç–æ–π—á–∏–≤–æ –Ω–µ–ø–ª–æ—Ö–æ, —Ä–µ–¥–∫–∏–µ —Å–±–æ–∏, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 70‚Äì80% —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π; —Å–±–æ–∏ <10% (—Ä–µ–¥–∫–∏–µ off-topic); —Ä–µ–∑—É–ª—å—Ç–∞—Ç >50% (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —Ç–µ–º –∑–∞–∫—Ä—ã—Ç—ã). –ü—Ä–∏–º–µ—Ä—ã: –ë—ã—Å—Ç—Ä—ã–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ –¥–µ–±–∞—Ç—ã —Å —Ä–µ–¥–∫–∏–º–∏ —à—É—Ç–∫–∞–º–∏; –≥—Ä—É–ø–ø–∞ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç —Ü–µ–ª–µ–π. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –≤—ã—Å–æ–∫–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ.
- 8‚Äì9: –í—ã—Å–æ–∫–∞—è —è—Å–Ω–æ—Å—Ç—å, –±—ã—Å—Ç—Ä—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–∞—è –û–°. –ö—Ä–∏—Ç–µ—Ä–∏–∏: >80% —è—Å–Ω—ã—Ö –∏ —Ü–µ–ª–µ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π; –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ –≤ <20% –≤—Ä–µ–º–µ–Ω–∏; 100% –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ (–û–°). –ü—Ä–∏–º–µ—Ä—ã: –£—á–∞—Å—Ç–Ω–∏–∫–∏ –±—ã—Å—Ç—Ä–æ —Å–æ–≥–ª–∞—à–∞—é—Ç—Å—è, –¥–∞—é—Ç –ø–æ–ª–µ–∑–Ω—ã–π —Ñ–∏–¥–±–µ–∫; —Ç–µ–º—ã —Ä–∞–∑–≤–∏–≤–∞—é—Ç—Å—è —Å —É–ª—É—á—à–µ–Ω–∏—è–º–∏. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –æ—á–µ–Ω—å –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –æ—Ç–ª–∏—á–Ω–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî –≤—ã—Å–æ–∫–æ–µ, —Å –≤–∑–∞–∏–º–æ–ø–æ–¥–¥–µ—Ä–∂–∫–æ–π. 
- 10: –≠—Ç–∞–ª–æ–Ω–Ω–æ: —á—ë—Ç–∫–æ, –±—ã—Å—Ç—Ä–æ, –±–µ—Ä–µ–∂–Ω–æ, —É–ª—É—á—à–µ–Ω–∏—è –∑–∞–∫—Ä–µ–ø–ª—è—é—Ç—Å—è —Å–∏—Å—Ç–µ–º–Ω–æ. –ö—Ä–∏—Ç–µ—Ä–∏–∏: 100% –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏; –≤—Å–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã; —Å–∏—Å—Ç–µ–º–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∞–≤–∏–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã –ø–æ –û–°). –ü—Ä–∏–º–µ—Ä—ã: –ß–∞—Ç –∫–∞–∫ –∫–æ–º–∞–Ω–¥–∞: –±—ã—Å—Ç—Ä—ã–µ —Ä–µ—à–µ–Ω–∏—è, –≤–µ–∂–ª–∏–≤—ã–π —Ç–æ–Ω, —É—Ä–æ–∫–∏ –∏–∑ –æ–±—Å—É–∂–¥–µ–Ω–∏–π –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ. –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏: –¢–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–∑–∏—Ç–∏–≤–Ω–∞—è; –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è; –£–≤–∞–∂–µ–Ω–∏–µ ‚Äî —ç—Ç–∞–ª–æ–Ω–Ω–æ–µ.

–û—Ç–≤–µ—Ç—å –¢–û–õ–¨–ö–û –≤ JSON –ø–æ —Å—Ö–µ–º–µ:
{
  "overall_summary": "–∫—Ä–∞—Ç–∫–∏–π –æ–±—â–∏–π –≤—ã–≤–æ–¥ –æ —Å—Ç–∏–ª–µ",
  "communication_effectiveness": —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 10,
  "motivating_feedback": [
    {"quote": "—Ü–∏—Ç–∞—Ç–∞/–ø—Ä–∏–º–µ—Ä", "context": "–∫—Ä–∞—Ç–∫–æ –æ —Å–∏—Ç—É–∞—Ü–∏–∏", "positive_result": "–∫–∞–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç —ç—Ç–æ –¥–∞–ª–æ"}
  ],
  "development_feedback": [
    {"quote": "—Ü–∏—Ç–∞—Ç–∞/–ø—Ä–∏–º–µ—Ä", "action": "—á—Ç–æ —Å–¥–µ–ª–∞–ª/—Å–∫–∞–∑–∞–ª", "potential_consequences": "–∫ —á–µ–º—É –ø—Ä–∏–≤–µ–ª–æ/–º–æ–≥–ª–æ –ø—Ä–∏–≤–µ—Å—Ç–∏", 
    "reflection_question": "–æ—Ç–∫—Ä—ã—Ç—ã–π –≤–æ–ø—Ä–æ—Å –¥–ª—è –æ—Å–º—ã—Å–ª–µ–Ω–∏—è", "improvement_suggestion": "–∫–∞–∫ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å/–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∏–Ω–∞—á–µ"}
  ],
  "strengths": ["–∫–ª—é—á–µ–≤—ã–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã"],
  "growth_areas": ["–∑–æ–Ω—ã –¥–ª—è —Ä–∞–∑–≤–∏—Ç–∏—è (–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ, –Ω–µ –ª–∏—á–Ω–æ—Å—Ç–Ω—ã–µ —è—Ä–ª—ã–∫–∏)"],
  "interaction_patterns": {"partner_name": "–æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —ç—Ç–∏–º —á–µ–ª–æ–≤–µ–∫–æ–º"},
  "recommendations": ["1‚Äì3 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —à–∞–≥–∞ –Ω–∞ –±—É–¥—É—â–µ–µ"],
  "agreements": ["–µ—Å–ª–∏ —É–º–µ—Å—Ç–Ω–æ: –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä–µ–Ω–Ω–æ—Å—Ç–∏/—Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏"]
}
–ë—É–¥—å —É–≤–∞–∂–∏—Ç–µ–ª—å–Ω—ã–º, —Ç–æ—á–Ω—ã–º, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–º –∏ —Å—Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –Ω–∞ —Ä–æ—Å—Ç–µ."""

    GROUP_ANALYSIS_USER_PROMPT_TEMPLATE = """–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å–ª–µ–¥—É—é—â–∏–µ {message_count} —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ —Ä–∞–±–æ—á–µ–≥–æ —á–∞—Ç–∞ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ 
–∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–Ω—Ü–∏–ø–∞–º –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –û–° (—Å–≤–æ–µ–≤—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å, –Ω–µ–ø—É–±–ª–∏—á–Ω–æ—Å—Ç—å, —è—Å–Ω–æ—Å—Ç—å, —Ñ–∞–∫—Ç—ã, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å).

{formatted_messages}

–í—ã–¥–µ–ª–∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –∏ –¥–∞–π –æ–±—ä–µ–∫—Ç–∏–≤–Ω—É—é –æ—Ü–µ–Ω–∫—É —Å –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏."""

    PERSONAL_ANALYSIS_USER_PROMPT_TEMPLATE = """–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å—Ç–∏–ª—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {username}.

–°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
{user_messages}

–í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –¥—Ä—É–≥–∏–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏:
{interactions}

–ü—Ä–µ–¥–æ—Å—Ç–∞–≤—å –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—É—é, –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—É—é –æ–±—Ä–∞—Ç–Ω—É—é —Å–≤—è–∑—å."""

    MESSAGES = {
        "welcome_text": """üëã *–ü—Ä–∏–≤–µ—Ç! –Ø Communication Coach Bot.*

–Ø –ø–æ–º–æ–≥–∞—é –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö.

*–ß—Ç–æ —è —É–º–µ—é:*
‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
‚Ä¢ –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–∏—á–Ω—ã–π —Å—Ç–∏–ª—å –æ–±—â–µ–Ω–∏—è
‚Ä¢ –í—ã—è–≤–ª—è—Ç—å –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã –∏ –¥–∞–≤–∞—Ç—å —Å–æ–≤–µ—Ç—ã

*–ö–∞–∫ –Ω–∞—á–∞—Ç—å:*
–î–æ–±–∞–≤—å—Ç–µ –º–µ–Ω—è –≤ –≥—Ä—É–ø–ø–æ–≤–æ–π —á–∞—Ç –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã.""",

        "help_text_template": """üìñ *–°–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º:*

*–ê–Ω–∞–ª–∏–∑ —á–∞—Ç–∞:*
/analyze\_last\_100 ‚Äî –∞–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 100 —Å–æ–æ–±—â–µ–Ω–∏–π
/analyze\_last\_24h ‚Äî –∞–Ω–∞–ª–∏–∑ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞
/conflict ‚Äî –∞–Ω–∞–ª–∏–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
/digest ‚Äî –¥–∞–π–¥–∂–µ—Å—Ç —Å–æ–≤–µ—Ç–æ–≤ –∑–∞ 24 —á–∞—Å–∞

*–õ–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑:*
/my\_communication ‚Äî –∞–Ω–∞–ª–∏–∑ –≤–∞—à–µ–≥–æ —Å—Ç–∏–ª—è
/analyze\_user @username ‚Äî –∞–Ω–∞–ª–∏–∑ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
/analyze\_user\_all @username ‚Äî –∞–Ω–∞–ª–∏–∑ –ø–æ –≤—Å–µ–º —á–∞—Ç–∞–º

*–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:*
/chat\_stats ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–µ—à–∞ —á–∞—Ç–∞

*–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (—Ç–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω):*
/add\_user ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
/remove\_user ‚Äî —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
/list\_users ‚Äî —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
/clear\_memory ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –ø–∞–º—è—Ç—å

‚è± –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ: {rate_limit} —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏.""",

        "private_chat_only": "‚ùå –≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö.",
        "not_authorized": "‚ùå –£ –≤–∞—Å –Ω–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã.",
        "main_admin_only_add": "‚ùå –¢–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.",
        "main_admin_only_remove": "‚ùå –¢–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.",
        "main_admin_only_list": "‚ùå –¢–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.",
        "main_admin_only_clear": "‚ùå –¢–æ–ª—å–∫–æ –≥–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –æ—á–∏—â–∞—Ç—å –ø–∞–º—è—Ç—å.",
        "rate_limit": "‚è± –ü–æ–¥–æ–∂–¥–∏—Ç–µ {rate_limit} —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –∫–æ–º–∞–Ω–¥–∞–º–∏ –∞–Ω–∞–ª–∏–∑–∞.",

        "user_added": "‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å @{username} (ID: {user_id}) –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö.",
        "user_already_added": "‚ÑπÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å @{username} (ID: {user_id}) —É–∂–µ –≤ —Å–ø–∏—Å–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö.",
        "user_added_by_id": "‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å ID {user_id} –¥–æ–±–∞–≤–ª–µ–Ω –≤ —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö.",
        "user_already_added_by_id": "‚ÑπÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å ID {user_id} —É–∂–µ –≤ —Å–ø–∏—Å–∫–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö.",
        "user_removed": "‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å @{username} (ID: {user_id}) —É–¥–∞–ª—ë–Ω –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö.",
        "user_removed_by_id": "‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å ID {user_id} —É–¥–∞–ª—ë–Ω –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö.",
        "user_cannot_remove": "‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è @{username}. –í–æ–∑–º–æ–∂–Ω–æ, —ç—Ç–æ –≥–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä.",
        "user_cannot_remove_by_id": "‚ùå –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {username} (ID: {user_id}).",
        "user_not_found": "‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å @{username} –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ —ç—Ç–æ–º —á–∞—Ç–µ.",
        "add_user_usage": "‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /add_user @username –∏–ª–∏ /add_user <user_id>, –∏–ª–∏ –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.",
        "remove_user_usage": "‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /remove_user @username –∏–ª–∏ /remove_user <user_id>, –∏–ª–∏ –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.",
        "invalid_format": "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ @username –∏–ª–∏ —á–∏—Å–ª–æ–≤–æ–π ID.",
        "error_adding_user": "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {error}",
        "error_removing_user": "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: {error}",
        "default_username": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å",

        "analyze_user_usage": "‚ùå –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: /analyze_user @username –∏–ª–∏ –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.",
        "analyzing_communication": "ü§î –ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –≤–∞—à —Å—Ç–∏–ª—å –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏...",
        "no_messages_for_analysis": "‚ùå –ù–µ—Ç –≤–∞—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –≤ —ç—Ç–æ–º —á–∞—Ç–µ.",
        "analysis_sent_private": "‚úÖ –ê–Ω–∞–ª–∏–∑ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–∏ @{username} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.",
        "analysis_error": "‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ: {error}",

        "chat_stats_template": """üìä *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —á–∞—Ç–∞: {chat_title}*

üí¨ *–°–æ–æ–±—â–µ–Ω–∏—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:* {total_messages}
üß† *–°–æ–æ–±—â–µ–Ω–∏—è –≤ –ø–∞–º—è—Ç–∏:* {memory_messages}
üë• *–ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:* {unique_users}
üìÖ *–ü–µ—Ä–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–µ—à–µ:* {oldest_message}
üïê *–ü–æ—Å–ª–µ–¥–Ω–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–µ—à–µ:* {newest_message}

üîß *–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–µ—à–∞:*
‚Ä¢ –ú–∞–∫—Å–∏–º—É–º –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö: {cache_size} —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –ú–∞–∫—Å–∏–º—É–º –≤ –ø–∞–º—è—Ç–∏: {memory_cache_size} —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –í—Å–µ–≥–æ –≤ –ø–∞–º—è—Ç–∏: {total_memory_messages} —Å–æ–æ–±—â–µ–Ω–∏–π
‚Ä¢ –ß–∞—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏: {total_chats_in_memory}

{warning_message}""",

        "empty_cache_warning": "‚ùó *–í–Ω–∏–º–∞–Ω–∏–µ:* –ö–µ—à –ø—É—Å—Ç. –ë–æ—Ç –Ω–∞—á–Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã.",
        "low_messages_warning": "üí° *–°–æ–≤–µ—Ç:* –î–ª—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –º–∏–Ω–∏–º—É–º 20-50 —Å–æ–æ–±—â–µ–Ω–∏–π.",

        "user_list_empty": "üìù –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—É—Å—Ç.",
        "user_list_template": "üìù *–ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏:*\n\n{user_list}",
        "user_list_item": "‚Ä¢ `{user_id}`{role}\n",
        "main_admin_role": " (–ì–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω)",

        "memory_cleared_template": """üßπ *–û—á–∏—Å—Ç–∫–∞ –ø–∞–º—è—Ç–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∞*

üìä *–î–æ –æ—á–∏—Å—Ç–∫–∏:*
‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–∞–º—è—Ç–∏: {before_messages}
‚Ä¢ –ß–∞—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏: {before_chats}

üìä *–ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:*
‚Ä¢ –°–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–∞–º—è—Ç–∏: {after_messages}
‚Ä¢ –ß–∞—Ç–æ–≤ –≤ –ø–∞–º—è—Ç–∏: {after_chats}

‚úÖ *–û—á–∏—â–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π:* {cleared_messages}
üíæ *–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ –ø–∞–º—è—Ç–∏:* ~{freed_memory:.1f} KB""",

        "last_100_description": "–ø–æ—Å–ª–µ–¥–Ω–∏—Ö 100 —Å–æ–æ–±—â–µ–Ω–∏–π",
        "last_24h_description": "—Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞",

        "default_username_id": "User_{user_id}",
        "analysis_title_template": "üìä *–ê–Ω–∞–ª–∏–∑ –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏–π: {chat_title}*\n\n{analysis_result}",

        "cross_chat_stats_template": """

üìä *–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º —á–∞—Ç–∞–º:*
‚Ä¢ –í—Å–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏–π: {total_messages}
‚Ä¢ –ß–∞—Ç–æ–≤ —Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é: {chats_count}
{period_info}""",
        "period_info_template": "‚Ä¢ –ü–µ—Ä–∏–æ–¥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: {oldest_date} - {newest_date}\n",

        "unknown_analysis_type": "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ç–∏–ø –∞–Ω–∞–ª–∏–∑–∞.",
        "no_messages": "–ù–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–π",
    }

    # SQL Queries
    SQL_QUERIES = {
        "create_messages_table": """
            CREATE TABLE IF NOT EXISTS messages (
                id INTEGER PRIMARY KEY AUTOINCREMENT,
                chat_id INTEGER NOT NULL,
                user_id INTEGER NOT NULL,
                username TEXT,
                text TEXT,
                timestamp TEXT NOT NULL
            )
        """,
        
        "create_index_chat_time": "CREATE INDEX IF NOT EXISTS idx_messages_chat_time ON messages(chat_id, timestamp)",
        "create_index_user_time": "CREATE INDEX IF NOT EXISTS idx_messages_user_time ON messages(user_id, timestamp)",
        
        "insert_message": "INSERT INTO messages(chat_id, user_id, username, text, timestamp) VALUES (?, ?, ?, ?, ?)",
        
        "get_last_n_messages": "SELECT chat_id, user_id, username, text, timestamp FROM messages WHERE chat_id = ? ORDER BY timestamp DESC LIMIT ?",
        "get_messages_since": "SELECT chat_id, user_id, username, text, timestamp FROM messages WHERE chat_id = ? AND timestamp >= ? ORDER BY timestamp ASC",
        
        "get_chat_stats_count": "SELECT COUNT(*) as cnt, MIN(timestamp) as oldest, MAX(timestamp) as newest FROM messages WHERE chat_id = ?",
        "get_chat_stats_users": "SELECT COUNT(DISTINCT user_id) as users FROM messages WHERE chat_id = ?",
        
        "clear_chat": "DELETE FROM messages WHERE chat_id = ?",
        "get_all_chats": "SELECT DISTINCT chat_id FROM messages",
        
        "get_user_messages_with_limit": "SELECT chat_id, user_id, username, text, timestamp FROM messages WHERE chat_id = ? AND user_id = ? ORDER BY timestamp DESC LIMIT ?",
        "get_user_messages_without_limit": "SELECT chat_id, user_id, username, text, timestamp FROM messages WHERE chat_id = ? AND user_id = ? ORDER BY timestamp ASC",
        
        "get_user_messages_all_chats_with_limit": "SELECT chat_id, user_id, username, text, timestamp FROM messages WHERE user_id = ? ORDER BY timestamp DESC LIMIT ?",
        "get_user_messages_all_chats_without_limit": "SELECT chat_id, user_id, username, text, timestamp FROM messages WHERE user_id = ? ORDER BY timestamp ASC",
        
        "get_user_chat_stats_count": "SELECT COUNT(*) as cnt, MIN(timestamp) as oldest, MAX(timestamp) as newest FROM messages WHERE user_id = ?",
        "get_user_chat_stats_chats": "SELECT DISTINCT chat_id FROM messages WHERE user_id = ?",
    }
    
    @classmethod
    def validate(cls):
        """Validate that required configuration is present"""
        required_vars = [
            ("TELEGRAM_BOT_TOKEN", cls.TELEGRAM_BOT_TOKEN),
            ("GEMINI_API_KEY", cls.GEMINI_API_KEY),
        ]
        
        missing_vars = []
        for var_name, var_value in required_vars:
            if not var_value:
                missing_vars.append(var_name)
        
        if missing_vars:
            raise ValueError(f"Missing required environment variables: {', '.join(missing_vars)}")
        
        return True
